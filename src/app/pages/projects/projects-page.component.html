<main class="min-h-screen relative">
  <app-background-animation></app-background-animation>
  <app-navbar></app-navbar>
  <app-language-switch-indicator></app-language-switch-indicator>

  <section class="mx-auto my-16 max-w-7xl w-full p-8 relative z-10 min-h-screen pt-32">
    <!-- Bot√≥n Volver al Inicio -->
    <div class="mb-6 opacity-0 transform translate-y-5" 
         [ngClass]="{'opacity-100 translate-y-0': true}"
         style="transition: opacity 0.5s ease, transform 0.5s ease">
      <button (click)="goToHome()"
              class="inline-flex items-center gap-2 neumorphic px-4 py-2 rounded-lg font-medium transition-all duration-300 hover:translate-y-[-2px]">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        <span class="bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent">
          {{ 'projects.backToHome' | translate }}
        </span>
      </button>
    </div>

    <!-- T√≠tulo principal -->
    <div class="opacity-0 transform translate-y-5" 
         [ngClass]="{'opacity-100 translate-y-0': true}"
         style="transition: opacity 0.5s ease, transform 0.5s ease">
      <h1 class="text-4xl md:text-5xl font-bold mb-4 relative inline-block">
        {{ 'projects.allProjects' | translate }}
        <span class="absolute -bottom-2 left-0 w-1/2 h-1 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full"></span>
      </h1>
      <p class="text-foreground/70 mb-10 text-lg">
        {{ 'projects.title' | translate }}
      </p>
    </div>

  <!-- Filtros de categor√≠as -->
  <div class="mb-10 opacity-0 transform translate-y-5" 
       [ngClass]="{'opacity-100 translate-y-0': true}"
       style="transition: opacity 0.5s ease, transform 0.5s ease; transition-delay: 0.1s">
    <div class="flex flex-wrap gap-3 justify-center md:justify-start">
      <button 
        *ngFor="let category of categories; trackBy: trackByCategory"
        (click)="selectCategory(category)"
        [class]="selectedCategory === category ? 
          'neumorphic-pressed px-6 py-3 rounded-lg font-medium bg-gradient-to-r from-purple-500 to-blue-500 text-white transition-all duration-300' : 
          'neumorphic px-6 py-3 rounded-lg font-medium transition-all duration-300 hover:translate-y-[-2px]'">
        {{ 'projects.filter.' + category | translate }}
      </button>
    </div>
  </div>

  <!-- Cuadro de b√∫squeda -->
  <div class="mb-8 opacity-0 transform translate-y-5" 
       [ngClass]="{'opacity-100 translate-y-0': true}"
       style="transition: opacity 0.5s ease, transform 0.5s ease; transition-delay: 0.15s">
    <div class="max-w-2xl mx-auto md:mx-0">
      <div class="relative neumorphic rounded-xl p-1">
        <div class="flex items-center">
          <svg class="w-5 h-5 ml-4 text-foreground/40" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <input 
            type="text" 
            [value]="searchTerm"
            (input)="onSearchChange($event)"
            [placeholder]="'projects.search.placeholder' | translate"
            class="flex-1 bg-transparent px-4 py-3 outline-none text-foreground placeholder:text-foreground/40">
          <button 
            *ngIf="searchTerm"
            (click)="clearSearch()"
            class="mr-3 p-2 rounded-lg hover:bg-foreground/5 transition-colors duration-200">
            <svg class="w-5 h-5 text-foreground/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Contador de proyectos -->
  <div class="mb-6 opacity-0 transform translate-y-5" 
       [ngClass]="{'opacity-100 translate-y-0': true}"
       style="transition: opacity 0.5s ease, transform 0.5s ease; transition-delay: 0.2s">
    <p class="text-foreground/60">
      {{ 'projects.search.showing' | translate }} <span class="font-bold text-purple-500">{{ filteredProjects.length }}</span> 
      {{ filteredProjects.length === 1 ? ('projects.search.project' | translate) : ('projects.search.projects' | translate) }}
    </p>
  </div>

  <!-- Grid de proyectos -->
  <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 mb-12">
    <!-- Iteraci√≥n sobre proyectos filtrados -->
    <div *ngFor="let project of filteredProjects; let i = index; trackBy: trackByProject" 
         class="neumorphic rounded-2xl p-6 transition-all duration-300 hover:translate-y-[-5px] group overflow-hidden flex flex-col relative z-10 opacity-0 transform translate-y-5"
         [ngClass]="{'opacity-100 translate-y-0': true}"
         [style]="{'transition': 'opacity 0.5s ease, transform 0.5s ease', 'transition-delay': (i * 0.1 + 0.3) + 's'}"
         (mouseenter)="onProjectView(project.name)">
      
      <!-- Badge de destacado (si aplica) -->
      <div *ngIf="project.featured" 
           class="absolute top-4 right-4 z-10 bg-gradient-to-r from-purple-500 to-blue-500 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg">
        ‚≠ê {{ 'projects.featuredTitle' | translate }}
      </div>

      <!-- Imagen del proyecto -->
      <div class="w-full aspect-video rounded-xl mb-4 overflow-hidden relative">
        <div class="absolute inset-0 bg-gradient-to-r from-purple-500/20 to-blue-500/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-1 rounded-xl pointer-events-none"></div>
        <img [src]="getProjectImage(project)" 
             [alt]="project.name" 
             class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
             appFallbackImage [appFallbackImage]="getFallbackForProject(project)"
             loading="lazy"
             decoding="async">
      </div>

      <!-- Contenido -->
      <h3 class="text-xl font-bold mb-3 bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent">
        {{ project.name }}
      </h3>
      
      <!-- Badge de categor√≠a -->
      <div class="mb-3">
        <span class="inline-block px-3 py-1 rounded-full text-xs font-medium"
              [ngClass]="{
                'bg-purple-500/20 text-purple-500': project.category === 'frontend',
                'bg-blue-500/20 text-blue-500': project.category === 'backend',
                'bg-gradient-to-r from-purple-500/20 to-blue-500/20 text-purple-500': project.category === 'fullstack',
                'bg-green-500/20 text-green-500': project.category === 'infrastructure',
                'bg-orange-500/20 text-orange-500': project.category === 'devops'
              }">
          {{ 'projects.filter.' + project.category | translate }}
        </span>
      </div>

      <p class="mb-4 text-foreground/80 flex-grow">{{ project.description }}</p>

      <!-- Tecnolog√≠as -->
      <div class="flex flex-wrap gap-2 mb-4 justify-center">
        <div *ngFor="let tech of project.technologies; trackBy: trackByTechnology" class="tech-item hover:scale-110 transition-transform"
             style="transition: transform 0.3s ease">
          <div class="tech-icon-projects w-10 h-10 flex items-center justify-center">
            <!-- √çcono personalizado -->
            <ng-container *ngIf="hasCustomIcon(tech)">
              <div *ngIf="getCustomIcon(tech).type === 'text'" 
                   [ngStyle]="getCustomIconStyles(tech)">
                {{ getCustomIcon(tech).content }}
              </div>
              <div *ngIf="getCustomIcon(tech).type === 'html'" 
                   [ngStyle]="getCustomIconStyles(tech)" 
                   [innerHTML]="getCustomIcon(tech).content">
              </div>
            </ng-container>
            <!-- √çcono de Iconify -->
            <ng-container *ngIf="!hasCustomIcon(tech)">
              <iconify-icon 
                [icon]="getTechIcon(tech)" 
                width="28" 
                height="28">
              </iconify-icon>
            </ng-container>
          </div>
        </div>
      </div>

      <!-- Botones de acci√≥n -->
      <div class="flex flex-wrap gap-2 mt-auto">
        <!-- Bot√≥n de Demo -->
        <a *ngIf="hasDemoUrl(project)" 
           [href]="project.demoUrl" 
           target="_blank" 
           rel="noopener noreferrer"
           (click)="onProjectDemo(project.name)"
           class="flex-1 neumorphic px-4 py-2 rounded-lg text-center transition-all duration-300 hover:translate-y-[-2px] hover:shadow-xl">
          <span class="bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent font-medium text-sm">
            {{ 'projects.buttons.demo' | translate }}
          </span>
        </a>
        
        <!-- Bot√≥n de GitHub -->
        <a *ngIf="project.githubUrl" 
           [href]="project.githubUrl" 
           target="_blank" 
           rel="noopener noreferrer"
           (click)="onProjectGithub(project.name)"
           class="flex-1 neumorphic px-4 py-2 rounded-lg text-center transition-all duration-300 hover:translate-y-[-2px] hover:shadow-xl">
          <span class="bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent font-medium text-sm">
            {{ 'projects.buttons.github' | translate }}
          </span>
        </a>
        
        <!-- Bot√≥n de Documentaci√≥n -->
        <a *ngIf="hasDocsUrl(project)" 
           [href]="project.docsUrl" 
           target="_blank" 
           rel="noopener noreferrer"
           (click)="onProjectDocs(project.name)"
           class="flex-1 neumorphic px-4 py-2 rounded-lg text-center transition-all duration-300 hover:translate-y-[-2px] hover:shadow-xl">
          <span class="bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent font-medium text-sm">
            {{ 'projects.buttons.docs' | translate }}
          </span>
        </a>
        
        <!-- Bot√≥n de Descarga -->
        <a *ngIf="project.downloadUrl" 
           [href]="project.downloadUrl" 
           target="_blank" 
           rel="noopener noreferrer"
           (click)="onProjectDownload(project.name)"
           class="flex-1 neumorphic px-4 py-2 rounded-lg text-center transition-all duration-300 hover:translate-y-[-2px] hover:shadow-xl">
          <span class="bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent font-medium text-sm">
            {{ 'projects.buttons.download' | translate }}
          </span>
        </a>
      </div>
    </div>
  </div>

  <!-- Mensaje cuando no hay proyectos -->
  <div *ngIf="filteredProjects.length === 0" 
       class="w-full py-20 opacity-0 transform translate-y-5"
       [ngClass]="{'opacity-100 translate-y-0': true}"
       style="transition: opacity 0.5s ease, transform 0.5s ease; transition-delay: 0.3s">
    <div class="max-w-md mx-auto text-center neumorphic rounded-2xl p-12">
      <div class="text-6xl mb-4">üîç</div>
      <h3 class="text-2xl font-bold mb-3 bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent">
        {{ 'projects.search.noResults' | translate }}
      </h3>
      <p class="text-foreground/60">{{ 'projects.search.noResultsDescription' | translate }}</p>
    </div>
  </div>
</section>

<app-footer></app-footer>
</main>
